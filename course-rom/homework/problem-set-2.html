<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Problem Set 2: RB for Linear Affine Elliptic Problems :: Course Rom</title>
    <link rel="canonical" href="https://feelpp.github.io/course-rom/course-rom/homework/problem-set-2.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../_/js/vendor/tabs-block-behavior.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist-min@2" charset="utf-8"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7" charset="utf-8"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      bold: ["{\\bf #1}",1],
      calTh: "{\\mathcal{T}_h}",
      card: ["{\\operatorname{card}(#1)}",1],
      card: ["{\\operatorname{card}(#1)}",1],
      Ck: ["{\\mathcal{C}^{#1}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      diam: "{\\operatorname{diam}}",
      dim: ["{\\operatorname{dim}(#1)}",1],
      disp: ["{\\mathbf{#1}}",1],
      domain: "{\\Omega}",
      ds: "",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      F:"{\\mathcal{F}}",
      geo: "{\\mathrm{geo}}",
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      Id: "{\\mathcal{I}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      jump: ["{[\\![ #1 ]\\!]}",1],
      n:"{\\mathbf{n}}",
      Ne: "{N_{\\mathrm{e}}}",
      Next: "{\\mathrm{n}}",
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      NN: "{\\mathbb N}",
      Nno: "{N_{\\mathrm{no}}}",
      Nso: "{N_{\\mathrm{so}}}",
      opdim: "{\\operatorname{dim}}",
      p: "{\\mathrm{p}}",
      P:"{\\mathcal{P}}",
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      poly: ["{\\mathbb{#1}",1],
      poly: ["{\\mathbb{#1}}",1],
      prect: ["{\\left\\(#1\\right\\)}",1],
      q:"{\\mathbf{q}}",
      Qch: ["{Q^{#1}_{c,h}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      RR: "{\\mathbb R}",
      set: ["{\\left\\{#1\\right\\}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      T:"{\\mathcal{T}}",
      tr: "{\\operatorname{tr}}",
      v:"{\\mathbf{v}}",
      vertiii: ["\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert",1]
  },
  extensions: ["mhchem.js"] 
  }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_CHTML'></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project" style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/course-rom">Course Rom</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a href="https://docs.feelpp.org/">Documentation Reference</a>
                </div>
                <div class="navbar-item has-dropdown is-hoverable download-item">
                    <div class="navbar-item"><a href="https://docs.feelpp.org/user/latest/install/index.html" class="download-btn">Get Feel++</a></div>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand"  href="https://www.cemosis.fr">
                        <img class="cemosis-logo"  src="../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="course-rom" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Course ROM</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Setting up the development Environment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/cmake.html">CMake Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/antora.html">Antora Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/vscode.html">VS Code Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/githubactions.html">GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/rename.html">Renaming the Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/jupyter.html">Jupyter Notebook</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Course ROM</span>
    <span class="version"></span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../index.html">Course ROM</a>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Course ROM</a></li>
    <li><a href="problem-set-2.html">Problem Set 2: RB for Linear Affine Elliptic Problems</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/course-rom/edit/master/docs/modules/ROOT/pages/homework/problem-set-2.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
      <li>
        <a href="../_attachments/homework/problem-set-2.ipynb"
           title="Download Jupyter Notebook" data-toggle="tooltip" data-placement="left" class="jupyter-download">
          <img class="jupyter-file-icon icon" src="../../_/img/jupyter-logo.svg"/> .ipynb
        </a>
      </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Problem Set 2: RB for Linear Affine Elliptic Problems</h1>
<div class="sect1">
<h2 id="_problem_statement_design_of_a_thermal_fin"><a class="anchor" href="#_problem_statement_design_of_a_thermal_fin"></a>1. Problem Statement — Design of a Thermal Fin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We consider the problem of designing a thermal fin described in Problem Set 1. In PS1 we looked at some thoeretical issues (weak formulation and optimization formulation, convergence of the reduced basis approximation) and derived the necessary reduced basis quantities, i.e., expressions for \(A_N ( \mu )\), \(F_N\) , and \(L_N\) . This problem set is devoted to implementing the reduced basis approximation and solving a simple design problem.</p>
</div>
<div class="sect2">
<h3 id="_part1_finite_element_approximation"><a class="anchor" href="#_part1_finite_element_approximation"></a>1.1. Part1 - Finite element approximation</h3>
<div class="paragraph">
<p>We start by setting Feel++ environment. The results will be stored in the directory <code>feelppdb</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import feelpp
from course_rom import laplacian
from course_rom.forms import *
import numpy as np
import json
import os

d=os.getcwd()
print(f"directory={d}")
e=feelpp.Environment(['lap'],config=feelpp.localRepository("."))</code></pre>
</div>
</div>
<details>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre>---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
File <ipython-input-1-22433b8a846c>:2
      1 import feelpp
----> 2 from course_rom import laplacian
      3 from course_rom.forms import *
      4 import numpy as np

ModuleNotFoundError: No module named 'course_rom'</pre>
</div>
</div>
</div>
</details>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class Fin2D:
  def __init__(self,level='coarse'):
    self.level=level
    feelpp.Environment.setConfigFile(f"{d}/src/cases/laplacian/fin/fin4/fin2d-{level}.cfg")
    data = laplacian.loadSpecs(f"{d}/src/cases/laplacian/fin/fin2d-{level}.json")
    self.lap=laplacian.get(dim=2,order=1)
    self.lap.setSpecs(data)
    self.lap.initialize()
    print(f"loaded {level} mesh with {self.lap.mesh().numGlobalElements()} elements")
    self.decompose()
    self.a_thetas=[self.atheta0,self.atheta1,self.atheta2,self.atheta3,self.atheta4,self.atheta5]
    self.f_thetas=[self.ftheta0]

  def decompose(self):
    self.Fq=[]
    for i,mat in enumerate(['Gamma_root']):
        self.Fq.append(self.lap.assembleFlux(markers=[mat],coeffs=1))
    self.Aq=[]
    for i,mat in enumerate(['Post', 'Fin_1', 'Fin_2', 'Fin_3', 'Fin_4']):
        C=np.array([[1,0],[0,1]])
        self.Aq.append(self.lap.assembleGradGrad(markers=[mat],coeffs=C))
    for i,mat in enumerate(['Gamma_ext']):
        self.Aq.append(self.lap.assembleMass(markers=[mat],coeffs=1))
  def Qa(self):
      return len(self.Aq)
  def Qf(self):
      return len(self.Fq)
  def atheta0(self,mu): return 1
  def atheta1(self,mu): return mu[0]
  def atheta2(self,mu): return mu[1]
  def atheta3(self,mu): return mu[2]
  def atheta4(self,mu): return mu[3]
  def atheta5(self,mu): return mu[4]
  def ftheta0(self,mu): return 1


  def a(self,mu):
    return sum( (theta(mu) * aq for theta, aq in zip(self.a_thetas, self.Aq)),start=form2(test=self.lap.Xh(),trial=self.lap.Xh()))
  def f(self,mu):
    return sum( (theta(mu) * fq for theta, fq in zip(self.f_thetas, self.Fq)),start=form1(test=self.lap.Xh()))

  def solve(self,mu):
    u = self.lap.Xh().element()
    fmu=self.f(mu)
    self.a(mu).solve(solution=u,rhs=fmu,rebuild=True)
    return u,fmu(u)</code></pre>
</div>
</div>
<details open>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We will need the following two sampling methods</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def log_random_sample(bounds, num_samples=1):
    # bounds is a list of tuples (a, b) for each dimension
    log_bounds = [(np.log(a), np.log(b)) for a, b in bounds]
    samples = [np.exp(np.random.uniform(log_a, log_b, num_samples)) for log_a, log_b in log_bounds]
    return np.array(samples).T  # Transpose to get samples in shape (num_samples, dimensions)

def log_equidistributed_sample(bounds, num_samples=1):
    # bounds is a list of tuples (a, b) for each dimension
    log_bounds = [(np.log(a), np.log(b)) for a, b in bounds]
    samples = [np.exp(np.linspace(log_a,log_b,num_samples )) for log_a, log_b in log_bounds]
    return np.array(samples).T  # Transpose to get samples in shape (num_samples, dimensions)</code></pre>
</div>
</div>
<details open>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We will need the following grids</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">fin_coarse = Fin2D(level='coarse')
fin_medium = Fin2D(level='medium')
fin_fine = Fin2D(level='fine')</code></pre>
</div>
</div>
<details open>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre>---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
File <ipython-input-1-75f34035178a>:1
----> 1 fin_coarse = Fin2D(level='coarse')
      2 fin_medium = Fin2D(level='medium')
      3 fin_fine = Fin2D(level='fine')

File <ipython-input-1-8503c8dea380>:4, in Fin2D.__init__(self, level)
      2 def __init__(self,level='coarse'):
      3   self.level=level
----> 4   feelpp.Environment.setConfigFile(f"{d}/src/cases/laplacian/fin/fin4/fin2d-{level}.cfg")
      5   data = laplacian.loadSpecs(f"{d}/src/cases/laplacian/fin/fin2d-{level}.json")
      6   self.lap=laplacian.get(dim=2,order=1)

AttributeError: module 'feelpp' has no attribute 'Environment'</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We can print the size of the meshes using the following code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">for fin in [fin_coarse,fin_medium, fin_fine]:
    print(f"[{fin.level}] nelts: {fin.lap.mesh().numGlobalElements()}")

sampling=log_equidistributed_sample([(1.5,1.5),(.01,1)], num_samples=20)

Troots=dict()
for fin in [fin_coarse,fin_medium, fin_fine]:
    Troots[fin.level]=[]
    for i,sample in enumerate(sampling):
        mu=[sample[0],sample[0],sample[0],sample[0],sample[1]]
        u,s=fin.solve(mu)
        print(f"s_{fin.level}({mu})={s}")
        Troots[fin.level].append(s)

print(f"sampling={sampling[:,1]}")</code></pre>
</div>
</div>
<details open>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre>---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
File <ipython-input-1-35af6d099244>:1
----> 1 for fin in [fin_coarse,fin_medium, fin_fine]:
      2     print(f"[{fin.level}] nelts: {fin.lap.mesh().numGlobalElements()}")
      4 sampling=log_equidistributed_sample([(1.5,1.5),(.01,1)], num_samples=20)

NameError: name 'fin_coarse' is not defined</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We can plot the results using plotly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import plotly.graph_objects as go
import numpy as np

fig = go.Figure()
for fin in [fin_coarse,fin_medium, fin_fine]:
    fig.add_trace(go.Scatter(
        x=sampling[:,1], y=Troots[fin.level], mode='lines+markers', name=f'Mean_{fin.level}_Gamma_root'))
fig.update_layout(title='Mean Temperature', xaxis_title='mu', yaxis_title='Temperature')
fig.show()</code></pre>
</div>
</div>
<details open>
<summary class="title">Results</summary>
<div class="content">
<div class="literalblock dynamic-py-result">
<div class="content">
<pre>---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
File <ipython-input-1-873a5848d7e3>:5
      2 import numpy as np
      4 fig = go.Figure()
----> 5 for fin in [fin_coarse,fin_medium, fin_fine]:
      6     fig.add_trace(go.Scatter(
      7         x=sampling[:,1], y=Troots[fin.level], mode='lines+markers', name=f'Mean_{fin.level}_Gamma_root'))
      8 fig.update_layout(title='Mean Temperature', xaxis_title='mu', yaxis_title='Temperature')

NameError: name 'fin_coarse' is not defined</pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_part_2_reduced_basis_approximation"><a class="anchor" href="#_part_2_reduced_basis_approximation"></a>1.2. Part 2 – Reduced Basis Approximation</h3>
<div class="paragraph">
<p>The point of departure for the reduced basis approximation is a high – dimensional finite element &#8220;truth&#8221; discretization. In the offline stage we require the finite element solution to build the reduced basis and we thus also need the FE matrices. In this problem set we skip the FE assembly step and provide all of the necessary data for use in Python (see Appendix 1).</p>
</div>
<div class="paragraph">
<p>We saw in class that the reduced basis solution \(u_N ( \mu ) \in \mathbb{R}^N\) satisfies the set of \(N\times N\) linear equations,</p>
</div>
<div id="eq:1" class="stemblock 1">
<div class="content">
\[  A_N( \mu )u_N( \mu ) = F_N;\]
</div>
</div>
<div class="paragraph">
<p>and that the outputis given by</p>
</div>
<div id="eq:1" class="stemblock 2">
<div class="content">
\[  {T_{root}}_N ( \mu ) = L^T_N u_N ( \mu ).\]
</div>
</div>
<div class="paragraph">
<p>We derived expressions for \(A_N( \mu ) \in \mathbb{R}^{N\times N}\) in terms of \(A_N( \mu )\) and \(Z\), \(F_N \in \mathbb{R}^N\) in terms of \(F_N\) and \(Z\), and \(L_N \in \mathbb{R}^N\) in terms of \(L_N\) and \(Z\); here \(Z\) is an \(\mathcal{N} \times N\) matrix, the jth column of which is \(u_N ( \mu j )\) (the nodal values of \(u_N ( \mu j ))\). Finally, it follows from affine parameter dependence that \(A_N ( \mu )\) can be expressed as</p>
</div>
<div id="eq:1" class="stemblock 3">
<div class="content">
\[A_N( \mu ) =  \sum_{q=1}^Q \Theta^q( \mu )A^q_N.\]
</div>
</div>
<div class="paragraph">
<p>The goal is to implement an offline/ online version of the reduced – basis method following the computational decomposition indicated below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Offline</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose \(N\).</p>
</li>
<li>
<p>Choose the sample \(S_N\) .</p>
</li>
<li>
<p>Construct \(Z\).</p>
</li>
<li>
<p>Construct \(A^q_N, q = 1,\ldots,Q; F_N; \text{ and } L_N.\)</p>
</li>
</ol>
</div>
</li>
<li>
<p>Online</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Form \(A_N ( \mu )\) from (<a href="#eq:1.3">1.3</a>).</p>
</li>
<li>
<p>Solve \(A_N( \mu )u_N( \mu ) = F_N.\)</p>
</li>
<li>
<p>Evaluate the output \({T_{root}}_N ( \mu )\) from <a href="#eq:1.2">1.2</a>).</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>1 The idea is that the offline stage is done only once, generating a small datafile with the \(A^q_N , q = 1,\ldots,Q\), \(F_N\), and \(L_N\); the on-line stage then accesses this datafile to provide real-time response to new \(\mu\) queries. For the required off-line finite element calculations in this and the following questions, you should first use the coarse triangulation \(\mathcal{T}_{h,\mathrm{coarse}}\).</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Show that the operation count for the on-line stage of your code is independent of \(\mathcal{N}\) . In particular show that the operation count (number of floating-point operations) for the on-line stage, for each new \(\mu\) of interest, can be expressed as</p>
</li>
</ol>
</div>
<div id="eq:4" class="stemblock">
<div class="content">
\[c_1N^{\gamma_1} +c_2 N^{\gamma_2} +c_3 N^{\gamma_3},\]
</div>
</div>
<div class="paragraph">
<p>for \(c_1, c_2, c_3, \gamma_1, \gamma_2,\) and \(\gamma_3\) independent of \(N\). Give values for the constants \(c_1, c_2, c_3, \gamma_1, \gamma_2,\) and \(\gamma_3\).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We first consider a one parameter (\(P = 1\)) problem. To this end, we keep the Biot number fixed at \(Bi = 0.1\) and assume that the conductivities of all fins are equivalent, i.e., \(k_1 = k_2 = k_3 = k_4\), but are allowed to vary between \(0.1\) and \(10\) – we thus have \(\mu  \in D =
[0.1, 10].\) The sample set \(S_N\) for \(N_{max} = 8\) is given the log equidistributed sampling.</p>
</li>
<li>
<p>Generate the reduced basis &#8220;matrix&#8221; \(Z\) and all necessary reduced basis quantities. You have two options: you can use the solution "snapshots" directly in \(Z\) or perform a Gram-Schmidt orthonormalization to construct \(Z\) (Note that you require the \(X\) – inner product to perform Gram-Schmidt; here, we use \((\cdot, \cdot)_X = a(\cdot, \cdot; \mu )\), where \(\mu = 1\) – all conductivities are \(1\) and the Biot number is \(0.1\)). Calculate the condition number of \(A_N ( \mu )\) for \(N = 8\) and for \(\mu = 1\) and \(\mu = 10\) with and without Gram – Schmidt orthonormalization. What do you observe? Solve the reduced basis approximation (where you use the snapshots directly in \(Z\)) for \(\mu_1 = 0.1\) and \(N = 8\). What is \(u_N( \mu_1)\)? How do you expect \(u_N( \mu_2)\) to look like for \(\mu_2
= 10.0\)? What about \(\mu_3 = 1.0975\)? Solve the Gram – Schmidt orthonormalized reduced basis approximation for \(\mu_1 = 0.1\) and \(\mu
2 = 10\) for \(N = 8\). What do you observe? Can you justify the result? For the remaining questions you should use the Gram – Schmidt orthonormalized reduced basis approximation.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Verify that, for \(\mu  = 1.5\) (recall that Biot is still fixed at \(0.1\)) and \(N = 8\), the value of the output is \({T_{root}}_N ( \mu ) = 1.61\) up to 2 digits.</p>
</li>
<li>
<p>We next introduce a regular test sample, \(\Xi_{test} \subset D\), of size \(ntest = 100\) (in Python you can simply use <code>linspace(0.1, 10, 100)</code> to generate \(\Xi_{test}\)). Plot the convergence of the maximum relative error in the energy norm \(\max_{\mu \in\Xi_{test}} |||u( \mu )  -
u_N ( \mu )|||_\mu /|||u( \mu )|||_\mu\) and the maximum relative output error max \(\mu \in\Xi_{test} |{T_{root}}( \mu )  -  {T_{root}} N( \mu
)|/{T_{root}}( \mu )\) as a function of \(N\) (use the Python command <code>semilogy</code> for plotting).</p>
</li>
<li>
<p>Compare the average CPU time over the test sample required to solve the reduced basis online stage with direct solution of the FE approximation as a function of \(N\).</p>
</li>
<li>
<p>What value of \(N\) do you require to achieve a relative accuracy in the output of 1%. What savings in terms of CPU time does this % correspond to?</p>
</li>
<li>
<p>Solve problems b) 3. to 5. using the medium and fine FE triangulation. Is the dependence on \(\mathcal{N}\) as you would anticipate?</p>
</li>
</ol>
</div>
</li>
<li>
<p>We now consider another one parameter \((P = 1)\) problem. This time, we assume that the conductivities are fixed at \(\{k_1,k_2,k_3,k_4\} = \{0.4,0.6,0.8,1.2\}\), and that only the Biot number, \(Bi\), is allowed to vary from \(0.01\) to \(1\). The sample set \(S_N\) for \(N_{max} = 11\) is given by log equidistributed sampling. Generate an orthonormal \(Z\) from the sample set using the medium triangulation.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Verify that, for \(\mu_0 = {0.4, 0.6, 0.8, 1.2, 0.15}\), i.e. \(Bi = 0.15\), the value of the output is \({T_{root}}_N ( \mu 0) =1.53\).</p>
</li>
<li>
<p>We next introduce a regular test sample, \(\Xi_{test} \subset D\), of size \(ntest =100\) (in Python you can simply use <code>linspace(0.01, 1, 100)</code> to generate \(\Xi_{test}\)). Plot the convergence of the maximum relative error in the energy norm \(\max_{\mu \in\Xi_{test}} |||u( \mu )  -  u_N ( \mu )|||_\mu /|||u( \mu
)|||_\mu\) and the maximum relative output error \(\max_{\mu \in\Xi_{test}} |{T_{root}}( \mu )  -  {T_{root}}_N( \mu )|/{T_{root}}(
  \mu )\) as a function of \(N\) (use the Python command <code>semilogy</code> for plotting).</p>
</li>
<li>
<p>The Biot number is directly related to the cooling method; higher cooling rates (higher \(Bi\)) imply lower (better) \({T_{root}}\) but also higher (worse) initial and operational costs. We can thus define (say) a total cost function as</p>
<div id="eq:CBi" class="stemblock">
<div class="content">
\[C(Bi) = Bi + {T_{root}}(Bi),\]
</div>
</div>
<div class="paragraph">
<p>minimization of which yields an optimal solution. Apply your (online) reduced – basis approx – imation for \({T_{root}}_N\) (that is, replace \({T_{root}}(Bi)\) in (<a href="#eq:CBi">above</a>) with \({T_{root}}_N (Bi))\) to find the optimal \(Bi.\) Any (simple) optimization procedure suffices for the minimization.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>We consider now a two parameter \((P = 2)\) problem where the conductivities are assumed to be equivalent, i.e., \(k_1 = k_2 = k_3 = k_4\), but are allowed to vary between \(0.1\) and \(10\); and the Biot number, \(Bi\), is allowed to vary from \(0.01\) to \(1\). The sample set \(S_N\) for \(N_{max} = 46\) is given by the log random sampling. Generate an orthonormal \(Z\) from the sample set using the coarse triangulation.</p>
</li>
<li>
<p>We next introduce a regular grid, \(\Xi_{test} \subset D\), of size \(ntest = 400\) (a regular \(20 \times 20\) grid). Plot the convergence of the maximum relative error in the energy norm \(\max_{\mu \in\Xi_{test}} |||u( \mu )  - u_N ( \mu )|||_\mu /|||u( \mu
)|||_\mu\) and the maximum relative output error \(max_{\mu \in \Xi_{test}} |{T_{root}}( \mu ) - {T_{root}}_N( \mu )|/{T_{root}}( \mu)\) as a function of \(N\).</p>
</li>
<li>
<p>We now consider the POD method and we wish to compare it with the Greedy approximation. To this end, we sample log randomly the parameter space (\(P=2\)) and take \(n_{\mathrm{train}}=100\) samples. Build the POD approximation using these samples as training set and compare the results with the Greedy approximation. Compute the RIC and the dimension of the POD space (\(N\)) such that the RIC is \(99\%\) of the total energy. Plot the POD and Greedy convergence of the maximum relative error in the energy norm \(\max_{\mu \in\Xi_{test}} |||u( \mu )  - u_N ( \mu )|||_\mu /|||u( \mu
)|||_\mu\) and the maximum relative output error \(max_{\mu \in \Xi_{test}} |{T_{root}}( \mu ) - {T_{root}}_N( \mu )|/{T_{root}}( \mu
)\) as a function of \(N\).</p>
</li>
<li>
<p>Implement the parametrisation with respect to \(L\) and \(t\). The reference geometry is the one given by the <code>.geo</code> file and the corresponding \(\hat{L}\) and \(\hat{t}\). Plot the mean temperature \({T_{root}}( \mu )\) as a function \(t \in [0.1,0.5]\) and the other parameters set to \(k_i=0.1, L=2.5, Bi=0.1\).</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_1_finite_element_method_implementation"><a class="anchor" href="#_appendix_1_finite_element_method_implementation"></a>2. Appendix 1 – Finite Element Method Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We use Feel++ to implement the finite element matrices.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer" style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">© 2024 <a href="https://www.cemosis.fr" style="text-decoration: underline;">Cemosis</a>, Université de Strasbourg</span>
    </div>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>


<script async src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../_/js/vendor/fontawesome.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
